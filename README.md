# Basic Static-Dynamic Malware Analysis

Malware analysis is the process of understanding the behaviour and purpose of a suspicious file or URL. The output of the analysis aids in the detection and mitigation of the potential threat.

## Malware Sample

> **MD5:**  1d8562c0adcaee734d63f7baaca02f7c

> **SHA256:**  92730427321a1c4ccfc0d0580834daef98121efa9bb8963da332bfd6cf1fda8a


## Basic Static Analysis :

### Hashing Malware Sample

- Getting File Hash is important part of Static Analysis. We will use this hash to check reputation of binary  on multiple automated sandbox like VirusTotal.

![image](https://user-images.githubusercontent.com/43460691/213197987-9981444b-cc9b-4cc8-b61b-70ea849f9c12.png)


### Malware Repositories

- The very first technique in static analysis is to upload the suspicious executable or hash on VirusTotal, which runs the executable against several AV solutions and gives the result. For example, the below file states that the detection ratio is 46 out of 70.

- You can check the below output, Multiple AV solutions  detected  our sample as a Trojan.

![image](https://user-images.githubusercontent.com/43460691/213198777-4b7a0c68-a0fe-4053-9940-2bdb60018778.png)

- Also you can find some additional details about it.

![image](https://user-images.githubusercontent.com/43460691/213198879-6cbccad7-1f23-4357-b429-73a4bc206e25.png)

### String Analysis

- Searching through the strings can be a simple way to get hints about the functionality of a program. For example, if the program accesses a URL, then you will see the URL accessed stored as a string in the program.

- Below is a string extraction of keywords from a malicious executable. As we can see, it gives us good information that URL, File Path and Commands.

- From the below strings output we can assume that malware connecting to external URL to download file.

``` 
C:\Users\Windows\Desktop
Î» floss Malware.exe
FLOSS static Unicode strings
jjjj
cmd.exe /C ping 1.1.1.1 -n 1 -w 3000 > Nul & Del /f /q "%s"
http://ssl-6582datamanager.helpdeskbros.local/favicon.ico
C:\Users\Public\Documents\CR433101.dat.exe
Mozilla/5.0
http://huskyhacks.dev
ping 1.1.1.1 -n 1 -w 3000 > Nul & C:\Users\Public\Documents\CR433101.dat.exe
open

FLOSS decoded 0 strings

FLOSS extracted 2 stackstrings
<2_/
ineIGenu

Finished execution after 0.875000 seconds
```

### Information gathering from Portable Executable (PE) file format

- PE file format is used by Windows executables, DDLs etc. It contains the necessary information for Windows OS loader to run the code. While examining the PE files, we can analyse which functions have been imported, exported and what type of linking is there i.e. runtime, static or dynamic.

![image](https://user-images.githubusercontent.com/43460691/213241539-750e222a-2a8e-42ce-968e-3642b72ecf2d.png)

**File Header**

![image](https://user-images.githubusercontent.com/43460691/213241726-fc75bf1a-ea64-491a-b09b-23448f25903e.png)

**Section Header**

- **.text:** This contains the executable code.

- **.rdata:** This sections holds read only globally accessible data.

- **.data:** Stores global data accessed through the program.

- **.rsrc:** This sections stores resources needed by the executable.

![image](https://user-images.githubusercontent.com/43460691/213242988-1eef017e-4aec-4067-baec-632085cc70fa.png)

**Import Address Table**

- The import address table is the part of the Windows module (executable or dynamic link library) which records the addresses of functions imported from other DLLs.

![image](https://user-images.githubusercontent.com/43460691/213243406-adea35db-20a5-4379-a3f3-66ade9e25930.png)
![image](https://user-images.githubusercontent.com/43460691/213243480-dfe7421d-c1a5-4ba8-b7aa-3fee41d954d4.png)















